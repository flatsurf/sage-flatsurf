---
jupyter:
  jupytext:
    formats: ipynb,md
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.14.5
  kernelspec:
    display_name: SageMath 9.7
    language: sage
    name: sagemath
---

```sage
import jurigged
watcher = jurigged.watch("/")
```

# Harmonic Differentials


First, some differentials on a square torus.

(TODO: Unfortunately, we need to explicitly Delaunay triangulate the torus for this to work. We should remove this limitation and hide the triangulation as an implementation detailâ€¦)

```sage
from flatsurf import translation_surfaces, HarmonicDifferentials, SimplicialHomology, SimplicialCohomology
T = translation_surfaces.torus((1, 0), (0, 1)).delaunay_triangulation()
T.set_immutable()
T.plot()
```

We create differentials with prescribed values on generators of homology. The differential is, modulo some numerical noise, a constant:

```sage
H = SimplicialHomology(T)
a, b = H.gens()
```

```sage
H = SimplicialCohomology(T)
f = H({a: 1})
```

```sage
Omega = HarmonicDifferentials(T)
omega = Omega(f, prec=2)
omega
```

The power series is developed around the centers of the circumcircle of the triangulation. In this example the centers for the triangles are the same, so the coefficients are (essentially) forced to be identical.

We can recover the series for each triangle of the triangulation:

```sage
omega.series(0)
```

```sage
omega.series(1)
```

We can ask the differential how well it solves the constraints that were used to created it:

```sage
omega.error(verbose=True)
```

If we create the differential with much more precision, we see some numerical noise here:

```sage
Omega(f, prec=40).error(verbose=True)
```

We can also use other strategies to determine the differential. The supported strategies are `L2` (the default), `midpoint_derivatives` (forcing derivatives up to some point to match at the midpoints of the triangulation edges,) `area_upper_bound` (minimize an approximation of the area,) `area` (minimize the area).

```sage
Omega(f, prec=2, algorithm=["midpoint_derivatives"])
```

These strategies can also be mixed and weighted differently (in the case of `midpoint_derivatives`, this controls up to which derivative we force derivatives to match).

There are checks for obvious errors in the computation, e.g., when the error in the L2 norm gets too big:

```sage
Omega(f, prec=10, algorithm={"midpoint_derivatives": 2, "area_upper_bound": 10, "L2": 0})
```

These checks can be disabled though:

```sage
Omega(f, prec=10, algorithm={"midpoint_derivatives": 2, "area_upper_bound": 10, "L2": 0}, check=False)
```

There are some other basic operations supported. We can, e.g., ask for the roots of a differential (TODO: This does not include roots at the vertices of the triangulation yet):

```sage
omega.roots()
```

At the vertices we can ask for the coefficients of the power series developed around that vertex:

```sage
vertex = T.angles(return_adjacent_edges=True)[0][1]
```

```sage
omega.cauchy_residue(vertex, 0)
```

```sage
omega.cauchy_residue(vertex, -1)
```

## A Less Trivial Example, the Regular Octagon

```sage
from flatsurf import translation_surfaces, HarmonicDifferentials, SimplicialHomology, SimplicialCohomology
S = translation_surfaces.regular_octagon().copy(mutable=True)

scale = 1.163592571218269375302518142809178538757590879116270587397 / ((1 + N(sqrt(2)))/2)
S = S.apply_matrix(diagonal_matrix([scale, scale]))
S = S.delaunay_triangulation()
S.set_immutable()

from flatsurf import TranslationSurface
S = TranslationSurface(S)

S.plot()
```

```sage
HS = SimplicialCohomology(S)
a, b, c, d = HS.homology().gens()
```

To make computations more stable, we use a finer triangulation on the octagon.

```sage
T = S.underlying_surface()
deformation = T.subdivide()
T = deformation.codomain()
deformation = T.subdivide_edges(3) * deformation
T = deformation.codomain()
deformation = T.subdivide() * deformation
T = deformation.codomain()
deformation = T.delaunay_triangulation() * deformation
T = deformation.codomain()

from flatsurf import TranslationSurface

T = TranslationSurface(T)
T.plot(polygon_labels=False, edge_labels=False)
```

```sage
HT = SimplicialCohomology(T)
```

We create a differential whose integral along certain paths (in the original surface) has prescribed values:

```sage
f = deformation(HS({
    a: -1.64556839529346,
    b: 0,
    c: 0.681616747143081,
    d: -2.32718514243654,
}))
```

```sage
Q = translation_surfaces.square_torus().triangulate()
Q.plot()
```

```sage
labels = list(Q.label_iterator())
```

```sage
Q.triangle_flip(0, 2).polygon(labels[1]).plot()
```

```sage
Q.triangle_flip(0, 0).triangle_flip(0, 1).triangle_flip(0, 0).triangle_flip(0, 1).plot()
```

```sage
Q.triangle_flip(labels[0], 1).plot()
```

```sage
Q.triangle_flip(labels[1], 0).plot()
```

```sage
Omega = HarmonicDifferentials(T)
omega = Omega(f, prec=2, check=False)
```

We run some basic checks on the differential to determine whether it actually is a good approximation of a harmonic differential.

```sage
omega.error(verbose=True)
```

### An Explicit Series for the Octagon
We can provide the series for the Voronoi cells explicitly if we don't want to solve for a cohomology class.

```sage
Omega = HarmonicDifferentials(S)
```

```sage
R.<z> = CC[[]]
f = z^2 - 1/9*z^10 + 20/1377*z^18 - 14/6885*z^26 + 2044/6952473*z^34 - 111097/2565462537*z^42 + 8696012/1346867831925*z^50 - 2280754492/2349206872443585*z^58 + 34168376548/232571480371914915*z^66 - 2763445569452/123694803060662746935*z^74 + 7004995526095472/2053952204822304912855675*z^82 - 14607657277648911658/27968667173065325998355726475*z^90 + 10660547148775042643276/132935075073579494470184767935675*z^98 - 189105079944810799209446/15323954201974951314611024961352125*z^106 + 24675503706685130357836249576/12969388796560574910247622987375471478225*z^114 - 138813856361363171256790974712/472456306160420943159020551682963603849625*z^122 + 8515550127000678327485867400511972/187411605246184977627604477338839587557049996875*z^130 - 292800693221811784752576932847145484/41616386420434783123506637506735392496901998230625*z^138 + 30963549253021138880538640101351481688176/28390074570224302525109375507532283730499089662958915625*z^146 - 36020358488773571462277872410430104390630648/212840389052971596030744988179969531127551675203202990440625*z^154 + 453139926061937342027516817932071772361772528/17240071513290699278490344042577532021331685691459442225690625*z^162 - 5014462600952091882849137614914665637056475540101/1227382262715140919847436486476960852927250317538181475769150203125*z^170 + 9594241269477405989159896686794374689928944823966796/15097154913964959587538767361286015972894377155810978752111111226578125*z^178 - 1820328744753839611731898871542196402156942434561204/18402283448005525879430371347615793124659751004392974100439703294734375*z^186 + 33670176456354085949161900587241365212195404701144601240948/2185433534122000072786745199037542430844264689160778051725687007560924654015625*z^194 - 15835872634965199596531265929250989173688088636235198216703992836/6595671187483208049671488811873288619424453495857565571778899274123984019688966484375*z^202 + 108421903986886708407874668043870417101299640039950432243358112975216/289622517513575148669124745218167976567547177456601561822383246026058262288562207295390625*z^210 - 368202460718312684774941064368799545749957319706349329491449076/6305081498700273910162773562910483678810111431206599832132635437769311464799268203125*z^218 + 240630831856396117641913218661475828355147320180181842463820897571669128/26402772025497398793649333885156720212662474399983949858283305368681785649570364889791457421875*z^226 - 41870166663303656573218101662319255073091200973629322014829957564895317635468/29424981921424088859215075182188197718886161062876306954437329124357035129642273579702224464586015625*z^234 + 937765512902034084131605732619655913216116025871870121839997804190194552413036336/4219395282622607221967145705749876611899681065611148035731540809787177052415053819961400477099311710546875*z^242 - 26405743186077768693140319680978447702882814520376175604462906522999941029716669040656/760397953040062570740301644432449502416287034474885654989916910712188783606341727335243665812291318008583984375*z^250 + 86209460067894093393920899885287826273385097786867716597338605229992767872461962611065541652/15883131716550454193549502088815216762696525992326858344022691313130299204708101377195391272258383641267428687787109375*z^258 - 28912287178478410081030732235530280527024287223571467196199307063822569942100361812752124738852/34069317532000724245163681980508639955984048253541111147928672866664491794098877454084114278994232910518634535303349609375*z^266 + 460122975284448967014028734913314631889499406700001605999578639302804621234760083979707404379317264/3466761810881224314564870462622707413915289030238925211200957954415040511572008259529459106915154490581468241782359408732421875*z^274 - 10002427708205627249814340430752846190525592938366587747298960558862287895331602127994541889817895592/481727506577945950084316340657847640098448678982101201050946300368991068888220268590659455021342071795633691399317963993642578125*z^282 + 406998719502379880148131425664788393790693751731457212865154940665494299620584545629348629946361792938074896/125261823552326479890139216512381391107769446227846936445339683238368884221004374467736735602513275070063343908074929697389923080517578125*z^290 - 187565264444082429140047720616949267735942314222932844440655942605055420420425807152664853394856881005090792917996/368805856796279097745643114365230979734505203585835932467897433497128090760441915456993022352420665020631088188998072394445263249521678818359375*z^298 + 26549047342887753058537861734525678437596461368159089680751508122925341455808990663901680528306391270589567186833392/333434022348999602461856433851111099405423113605558031672112725102630805692054077201799600663165773966379652003598711814796194819681190531689453125*z^306 - 2088759429347861924785264928767495165699507169896039864776747849534058004145318444807924838031400420204464893054864/167519821822210073146967999671585512221344196723177630679568672483344208959250282767517295357256640853092826769063237236005150848411256238232421875*z^314 + 119743685111588777122142901623282439933905292297264383780557377973069570019953567918025338717356250471946777962192144/61313118817954867889687391092266020807970468874638714427061283365581976763896940095223868457389962212572462514558256407384204797841957321146044921875*z^322 - 2543132910903208818682292315505499408882791542092317991395356762704047618112263842822071338420754690128567172150884314649904/8311964049543461732768630040383583284150608117387079203933921422040629597268082102576400663569326902321100491568197955371837727130167329795838104413818359375*z^330 + 196640085235981805363701193696334825438948399151223909507885094214164319489419838499686375745010726282532218950468426939249952448/4101621024254621213610032473488588427071205977005090159693305234563676168283398951784432255408496092371470037560107365948882011026222631454933380473306042724609375*z^338 - 496047986318793746606687803773660916815414932494424846435802449411006238295595977242775875140354826821500866761480167178713047819285014/66019934002042814076918685685188255148855328607026574510742862960545770861583518248460376864558222204080631641299704208647795833516730023033863533167781988751833251953125*z^346 + 480968021288855790130530712961736225335450420187280492322969452120270796473295160817832978125572470571453324327451900125726015873911435115644/408374158141782069567655683629328489625607348882867112798566757243148170611057380564523227880571765871783032612424635047391770215921922048348703914169762457481126048113037109375*z^354 - 18805641534118505500668368819010662786664118682516235511351340914040825061828237660644956146361690115108710296670831892487180792237553088878274/101846719989315868888329074065578132659924821790073287087510687424541183868329090680350051173072266224836438737790957059346771703849978251508503684967942406291584128153026123046875*z^362 + 11358661628891554804033034461062168174884068641840004287280894555241379565180946152153155975359761947354294960363198951788074850663995282770815784616/392312648778364823115023598338940376802836474211966191201507380363145819390148842338892273968213811847673938490022126473990230482284781575006492617963349437553525437388303248741455078125*z^370 - 215167942383483876106784261085615392891541884394251204274336312689183392624199924777705369182591412518260167320365960119844101558220037355649254793688/47387238365597224686788376746729903408553142542971705726708391470179981868441662798303040460897405167916404675505304224095135734570714406033678976748730892588702151516113471361138916015625*z^378 + 3665151341239850954953621368385698347820062660491983315312830444805261305443435229814078083294742024655395347957755406115713371559967938770219693658540588/5146235860642948755898799719165349537129098759727287637418328733510980577073584410025403154422511702233733887604231613619722473414481672682024446998382656192482057999976262946176855072021484375*z^386 - 203113828143005688364165276923022186311970518687013254684661588299656227840254573071900270536167418641365550561873813746844638594202027859727196978678951544316/1817980076085374036706840384949674847475209388184519942740164819787197256194175267995353980586170285195814325878237843019674279096723638200990326604668213209857341986277713182581915978231463623046875*z^394 + 2725047240338338971865173425673569106180800429651893689614595605258691515133155380893904675366748906897287601634009871271334212070123029432437381056372188699604451856/155459018766727260495343741012909848426442889115715011677340109114147909924508874000483945488024079356737231266365508499244930700257339744190456329854875187688419513184568665800904237733026510537750244140625*z^402 - 2719970523025317650873526077945647784936095327498858127848615809738758351026204202953537524329823170897802839810689166555970697396253755811978436990116364030069023580840400264/988874312800214643361440797083081808855931870811867372243526029125440000233062457310718859961175592378467448639198174019296863425644453633032738929101382619424086848099867333630169433707642777480841818423614501953125*z^410 + 1939128939974432306644350857331145650002651646395114920460524764159142521113905292966179925611601080422754157241822742500667040555820159339961390873333830595645327936055350450672/4492246314040468091324481428401107377634476026436550955647501568893830454263572600198153989816448225929282907998045378209873606870458278850241933241592494681801435419248702626018342978514143372879998564038188446044921875*z^418 - 212362485436646331288393023222771185225664788904250794090354416963731677973482224594158215416460620633937687399963877772827886076907769999723005572035231342485409206218949307527746/3134452524285709027018109321937673768603308299984492339877341891394656754873247717028371292125223957201976024652042761422372798552085147424133093968955114833197605955441718387242139422206104763307862734325327201995849609375*z^426 + 4355299201146129109201611955275230480210501138022661935322103652953632661022948827220141971119229506883684913653467210436443619269731397993012345255654055349783586895883016088371812424/409522656174161944519497756925028423619441994078431787110303940023015294056476133001386399130918030204981897992629462025501188896048005106791911947605290450298240623690684835030927749376357378804370635010479719349225006103515625*z^434 - 1015680250109545046653406562418792256026479782725911560835850949063340895764151257185700806814147365295029391753546635377561186250426668763216717485688204696059745752731675347409919222310984/608336486725625562858989969463720447632937835037646615821252965913568689969131996622500464021798722754805894884397235361255429577734702482021928984192864042237679586958167436687237460360343229994180077783462382059728714391632080078125*z^442 + 1696834966016019547178523780140114333988681249511446065842478179178764663786327250518351713201726592424040454059528132936612512358878856913148091114927580136282751898525257776185385884091399224/6473006186816109705818724364723597493217114184421732773180408518871274135464744185008451756951949373965774712700549742616572603319606745945464637196330750293690509638163253267370658739086895926750794993927350954005898591782132720947265625*z^450 - 218965572174369107254003321304962287012465721291038050268607828228179016597758549923792145287230694347666158398378334631331104560195546740613163483490360590029634690610259197934499160337649489407206584/5319565010603431177525975147101064934243774658829359407181193747708105199932470597437173752223519076588973316320111548017848406819553452818440978869054060855466741105910316091274023324647132653037738769076482203372906515232328234500005340576171875*z^458 + 50376944918356268475603454033681314045012486881886490066310097598408438175068884951106514364167411565301848987041709770384720781615852831432743922852296690421790388654223163002728890199832864181379471264/7793308482041166495107814576123528650994095458052376719449412708714229134481889492933060565466420475122752455623109174326915528275764152309230237905598967757665774808956035274157300993164888984170233536115377290467427850473312434179069467926025390625*z^466 - 9238023690613409114156501748441676019964242600053413567053766299917041942137728208509773311861885430210494778502029639976847820392540505645312075553692614799743633567083837063120155996205715201443854232/9099473375955379772346663608294061272473078510898885790952485843489847031799018203573652807880888212990215820024193500741788862201408287747523644832771125580071549233532945629060493203365866960191109314007031775513643372644232604282082341156005859375*z^474 + 59299629317753172919073643470841601137511633945919991865705227689122314554533495197523845549261349956235026077025812629844855717922207698305365179087238619767759818492132020814029401201048917367128435188961392/371873410652359679499860201011728171107388971525048532478185036645259585310573761360911524150032790110993619291025229706077611960180718305143503619476636432477992543667600170466551885525544820435632174223380921613186984054791124272943321233368656158447265625*z^482 - 9652636453831276744993409255650578919412693673483950389576037238330784744041009833354250628868158326569936351822829621727547160606084232589027129025945371179744699410822292430309935967509563769082060665778645948584/385349881398699070922842586515152520563542236270634651268313642573505092648732783592951427601738146650988733128535224247903541061462933685457356481265223955852671072277557949306178771336253811727547047876046288110269200714073993850179768845398706087520599365234375*z^490 + 3471272390988151543117055842745269054219326939458614271473997686077467843166448036766531999268980330642515777959748641846184404505413055502007716252668003989950505350798589173519846988070760880977370135122902478003666534368/882115727151069980214981816896470167790916766309041344289277206142568280147631326127911731821282321969721094043141395742938779743018241414235679537976100215558558812461637327491630685290837770035687981037854970106608371992158224106461553831907617703714909959243011474609375*z^498 - 38092219630315912752043377929003636546870942720734533523041794598766770964450378338998721682473292020401956163841260126483599470599872296762838886987497467814520281946887032722301328018754893449344159768178070872773330656/61611733596880469841798878997239022708436168255893183853320721233649302487495203445328161563229813883152432532348300131048992811255697621594036101087919087508746424785456136675239617616700347134174519070440606032776706928116843739974498544787736382732928149509429931640625*z^506 + 1952869066964938503601901652419136921565884527143018515479364203797658084720767317423660379849205820285280876123962536711398395255526920708595811768965089535835299301802237537890709681330677241201482304113270669765346533606984693332/20102700888618959968715971051072638159414162625967887612522675751213980133592357003110658874020605673859261178474084315688042041275515965359554368180511763833261245142519053667622113232154288373994562348888088944542976165148663540033940962821085025680240831461019516542873382568359375*z^514 - 1984272309211199467463695549498467035794206437397205577026937356733711365718389620402394142082824888530403959376777725299510481505457760144110925952705355900146109654467723226692389723293523615952391174383581248077243525084456896481468/129987521844796867223717918502218224361079280016461516128720714229126043429603754577633005786337257324301556238933341637059945712008288726014750887826392126736147567982092074554688285922027112891595970407906255993688143462841765071284715917253632697379385129372888637556528415679931640625*z^522 + 4232822519152817397794757225388867263497679422635964387955175449706625471036813393788168281847809864947279652667929701602143141746968356773077271857155577945523018304850766668268487578579460306719599516259393888375992439674857487112222416/1764475355988992130969077044948177401187998530450172400057805784150888771505510965351224221156179007240288928327132312446459564703903605861540109900714668754348680038945578380035719644722755282513219674019790658915131374922277088968138371033465226917372619216152450794394604798793792724609375*z^530 - 14194192077498382610974041153571526600459511981937346408450460208280866209072872668453222019801179777613545070636845077948859565200482879017253774979502550983574903898292687374332065840737065104603703435120941437633008377628392342744555503604312/37648564019590807713809319259133843429851769648048951693769196951357176240827094535070053789996253646385134383419481998720826753501345157699942092058077831031156147043178026519982355306834872487980457443387656546348667282970463825275852050439054940152110843996950782268463640905565968227386474609375*z^538 + 2120611737358444066931181747268893104964556293302951388433109668469603480305426733633625049782413968171120082895381034971825331954383351403769934515279019033730988989851726872431532664531377339907608068313526994690614318713331247270992736961525887952/35786491802725649242205377671795523993809437335625157102804426101698859127286898584219644503790368938471631058223290442920199050207263127120474014040000920193186922169891470871164278527601924371216646320655953792489162332453411980058220438870479056902409650991860120806948033964657295036627674102783203125*z^546 - 224745320378791467163577626628649450214274206384080961095767154403345777014976507428481717347941481367308702124710268499322904003887666381453605590197438005712529697131543094540107467161103047497953053609692323898883631635597588447197203344215294013908/24128915693581872403894817398976167311964182556458911852227609087204319467620229995964546650165532978381276579829846356015715684566355536550405002606138454031982444485647625246170646477570468615095280237818098703461746901062917077511939383661972374480848403536497586477205880451570619987058717250823974609375*z^554 + 138219962757611313080547498644406012868347220580697478341621846592457585782319315048811755115625719056213895483608811199193149074798461400575088214753257096136581603482160640355280530213592233880276115258279256883060409020273624901690980612908787255875292176/94401076989689055063719139483510594873138125159135257750916765371241952925297085887701841625881575099898706383692837178960713462817080446044952167211159660431928932455201800050983928964927031302360015877070730097771710491083217446125843702881905224941015502605262306922720630061148185524429004199585437774658203125*z^562 - 36406948983933313899993807017529564824135080284928550365531535770025719850912200497549875029126581976651273957842536717291312786834502613835031855968825163523377091469836986329678424660062028433466246157187701234779251020883088920832819104067111246611114745872/158168570525239018776338412401164954128261761447642177626659103775411550837281622436950998385660347263431652828158065051477087878652804402295385521818448676831176950225045759362576693722083486300242617500551952322853454736384435494226767137545513925425794157259439497683595202970810401081938769369087292194366455078125*z^570 + 389518328751160733124726007522030187365875744936234815952072158973427655503093969489910231674359160390975025597030346184495386750846723435443801701578446088108257590854727580849408539532524748252750825877227781087664658382223710502438279775270267206116318347470248986896/10763785728271454332682547426842847600485637705119388720015574782180981017038886578860669470642679106397189043526794878030027523599505266663002387368977574146161586099906517788487716296716686380798417074834186870441389465895777579338243306434624512751590016680543758772785306649724663531860286523064416001029641191959381103515625*z^578 - 38813058221053317164890619698486017091246775086702727821639911388543644337577245295132885047880371997276954181603519344614395392599160237119761237741391445648856971897280424411480539389627213443585402777675972310259302106755341148232362507077823768732624406592528425349995075824/6821636087737857598866555126157497977314959910296011034194726715501687225958484692235180530117272945426365629603700064469576223034402346480636249207465014905009051389727810383363963668393379644419071473157105286794915389948957365860185382348111955131012232129175037555540933914156885604030837462366917678969964890081211588382720947265625*z^586 + 18175875299714629491695114289470767820941990389862672463651318579770468326400197986632372817789028559956989237825481205532072644691255813977880998711806347720516144319294124885448182626368745210892272218815180874211822869503063862910874529042601915732311364001819569761456869385408/20316673633989540497979260249808005755618246818823321041831336133947369769582143619833852080007158598862188577220676853686121947736374159361811341463043458789741663775557975220125001629633526430410586288732236217250574700736890348498920202589031508124686294918167081116272536721177991732889956972201739330646738943674135765919208526611328125*z^594 - 45408321446820008449568942429958445845535205166957338140155795011866034906138607423012743530886565823564779950138646439182780153018645502246933695913016032899531193749680980546555166245628482918258207814367867747343592090491122481936356670168855511549531977329245445562034266934000536/322784797696187172067237239909060901012795593387910565083382762756821004804505968627984697023759666538214682896534392390364163064628343567056835428763504215300511665590117921855529048020281652393967043236328271125770165350068721648083143567951884442658966313077257162792396483234878234444279542464689858808113697755710811790090334415435791015625*z^602 + 10431114289639736386921234028792936660297466115048429194410579706854168390578437833092405699090814930874236038706384501897469557141064076870287432719114345288814676012383426345685809379788263732646631256494388377848513992862215886387409950197401442135989089331403901518818075749241681552/471523284185280493230026115884311274911839296867102479076289013552679334560033941824098315626919867695392413335528913137602390056907353848240452881336732985414597914091236780521132089234322859714224794665323681008263227517707290426314770999811373600848047442486893965234574149124406735274395571001235149837841511968017525028626828587055206298828125*z^610 - 6333457768095006778675858634554569805391006851402831655845433541492496770031742393143957753356742476655764389346710499712448374101152499297186194487422107242955776384773209451619948890471684501124312040420993629855883913121025501613925214143846217742625753725474738264629246859255527419427528/1820468882493149139938714974560844547814144748577019632215483769069302040169067678076480424587822610923212811246224376721554770852074514403971818922318686212048760990641242313736277983458770171665307695126543841932892643062385845789475383071272781265571495435839965641806541285294295648313515521965140415382038120443072784129474200253215358257293701171875*z^618 + 2284468815414964090097562325394733262266133494883932992832270219990047047085598435641442530937897236191954358819137564957124262639554895535025436087478332813310221386563783942852450123224623176618591609810056358189741016887559857515437995403191734691857027621320688210184667353049659706849376524963104/4175161909362345963167855831485724777141849730019797841551939416667169290108073967531123324263611932422444546642154488518157782023092124687036411854140730055755814959869811548682154397316516023513898317902843805968518831161141519967164512287933526268129059089098011037422340058344215223009991656046013981978976400556460296324994959776226450027073919773101806640625*z^626 - 44077872997201869788766284407575857395455558328834839198954511384910851831975198775813080537347458206457291016552741503089132582433269441534671735579600970458729473335267716447635893890981057716380445411870863545569740883643794119403298220288014332679203957446313023765065470973125593723633032226897818592/512189657295789535970001981269843881325787272370070708131520788715411659531724017196467566253368299254696353737144958740760413172795635632832066638771455715881866902528013079659202763552562529790976881708058525034710435020225500418579893410727160508353239575378734143220200535593399940168839930402107183644863721528823989435787286688532490247651303937733173370361328125*z^634 + 9802989243791401579588278129913285250112663178684412494076682878097174523412887456847192172314047265799719312342304018255245304835194996672628577470908031116406134357672498939303084816657818940704535855280601899993356133136981244445496737283752839484204962914359111681979726532425160748629316781271664059642256/724215410052039745959503212213265980862751420584129911406126079102142038641079903211885985785532086527930357101258530018167466669719339035908050497875838121659892800092431801714240117056088037833044727812052370708261241698055943781366440724480887217157644388085399677980605131029550105177366729467190692380993741485339898694649827855025992170980505236714741885662078857421875*z^642 - 522491410137391418803179310045788944779010547356739560934502407901771969378399791772498060313160131965909258298131895216805456378454738987797695340644809570216992521604364953884479115837273575587681816070126252411562219870898802314864458328824925338487773721741118636118984639450841876963109675498135178448012407415824/245394595386369644271696609005970285011546485200884102497353460730392015863856372845979359724519885457825240461153367466778293533560087885750373375701064391262916675955016919083485829335518564857967263686131707209627331701376808895423111145941550199004390478470331611667019639591867920204401778855526366204936779991683608077278613060589046328392261459059949296040289103984832763671875*z^650 + 1140806753412610863901487368960354894126963613800368416493134670781013734601255125390533689690046884054876833569181124107332318276060591374355920263060628866739860894201985322282445237501186653065246217000507713101854065721597675697499633889865726666911066713957100096438710853072860179245909773553068901944880682118848/3406062533048102595084787699488903273573220000220353734471731409780050652872498624031286131048637841887528120435378565783455888877037660040427284015371144685472528929068975726570703312011486571295800461788245018751573061338234060251165727977003515934786077602494461418058266928362386688687655135754081419597841317515779864221095178512448287569769335918946262739202125370502471923828125*z^658 - 5702603499778717982195087358925065865164040219813751820943475967958772977017332167941734061465646093509309681559147088132434621615037334912173123454362040399441344493417626930254165262720519807644243539207501600047687615578844482864606591507298496756686469272419596024842029127239879007203701164391876801973889362144/108229842409420650152441053446574470352571335263584077096511835637894920506399605401100249286735109339112252092498733615056988226380682372665583814965262063376985371109768681831380332297906334542586224794304218762389103537634272203015541004954095007169301667841750020347849601061578680149192071715110136346647267047313130124332411977028583230023158842681408765926028788089752197265625*z^666 + 1143920836051891506978423935104851496503140007699763904201585710886767409095134657060305713569398870333234081983659576327220558025730515088739559955748577306919663061015044622222676152880077559331889106333644970389469022175094648495251229105389193839230256195425261126577107519681618840735854850803263463532621195834724293184/138001011010693500284285128198387246033009570836011379085658696885189997199673345339863497609839130889032245936709896828937735739576586387110755778373635738286266672685826635010146712245126236941854661138306488544617684711189861252723524346307067020945308745067383497455593766284241990625339663654452233121886354450981256036759863936554612565240059252041963605115777556360553205013275146484375*z^674 - 5595091237406518367826371973525905324127140609303657778754134861465385945276824254627713871372621715866919874515574540194487313480900109347296342435948003518173955338586862788661079766455185200163261245343923003890744688793660349202169802451698727605260276447155930428230702034747507885618092157569582534265251915230523516946834999/4290279061880610440262326457737136994158718169714077149193495085083501405592461359812438351664357358012736444190364182910704779051901190649682646711313844808971354304446664224815893809245349499701508674279281411812126703304065633672665819148209468451817489846954665492086086003933636563894214952982086432194005472970532590700285268848820130474246237171722003576294863072271785418413579463958740234375*z^682 + 5614911904735188021014641395170195181774522757061699740870928011632719412968152665889223753433141229404786188104445116237785734645367094763482800247198317248122680097454979466232862827047337032307897015569095284146287014797678278327468289025787497843970496889112993088219539059784969803339541260209448550349690470906880765055973279816347013428/27364876097607748536360055172052863122972576314754134456229812076214492300101951064217446515548775005926312954021875728440134607591837137978071412727495471824952715541376745180909080414316420502824750014437544152671686455203836478565053375102812689674156020732177247271795612517569966054432240795696240562322694948152931049764903154144553911345250786085720740530493714074009163805708552318709962069988250732421875*z^690 - 1068437834990191797211439771458690787654943066132564107423388593285121641890207709920065299678853654014197388986523669599304312211454749785572110292759144393073396830328623225216582516346005496888270850973895979949191453917805421902841372049650834828574479390862964427104499158641957881230360420036774000149800089670959844693936521372067474348/33094248652456797102098829013743514627030455219289123856550917901309718565363319650247935606716303376166524226061157980432805936653864346739240788902945651582403775706777775693048517724890477311397658924342917769367551404182314677084746447275871216951220497021967972264502386219918333730374676404743111055995809795597327255672881720830689548075719718742187431144743988507086848766764940947612799704074859619140625*z^698 + 5071886940497923536981939909259345754577360310923849732855012012334594782516218331933111415421941966414623646403158213274394478874504920793940610929211308847852943540481944710130872322204707005587414884407845862237458498298441684064139269519734630867966160880276076451990594335051590613308436096266415482975231165903386311249941511218098446156376532444/998404567055872048063648899680912217764431924736768272559070637281064767794034411420187766544647043860320409849965427705410566302196445780194518400050036253935528799084820968301799547863565014739329644994640998673924601001665239158349908590250370750345463728453252888568471305825495709451825475492513012027812822206482029652087230492998838468911378337300106501215259800130317270111912795302335252711399905383586883544921875*z^706 - 27325448455327129673461985314497421149474511962572851283473010924522500328559994859711612855466666159556029055802907287170282594566856901549843210559173667508946839935438680360552639782232084452746186192158086249176504833699227577323517826176004157150288600909429967672089137139991993155370217907321151880578471804946534926924290174718202898462786044892/34183729997289101684657136882605749775776599259718467525198168642809259647987667941112853705743408011016961356688334733211590249259899046628835144519727222523782895536805558082104012876719868891396618571388432229176520188303467212253815964676450825141265569820180214380335629768340964392104195290309457975801444909403549203860039942031397648516463161743955570568755310854638708108234437480685363265889487244188785552978515625*z^714 + 162992192153624047428931709401786345022271064372801282402626443378345835324570070687185356482524521829553321940630317003483840459775982077904248294562235682445636176954052079881767250693117184049164644628321201616727822642545688158907993241099980362576804252731719865354876371537216551980554521170301151784591397711034899434853708102398531992677976128010608/1295734285547243399356928773535170945250811994939628511542636582405684986956972553307882719716203880657597920225271328062385328398196473362465996153020260369763990655322614679102152608092066630328388826948478523646935997737642924680480894141060868526979671424033931026086622046368964255282709522479180004572753769290941532572314814002700127867016536145904635902408670057945080230842626352705378694593541013990975916385650634765625*z^722 - 5470066142359267187940733605664460325374682791514760831680474381359758822468389166026920233422335931454832775601145562899181290886595126535944799483699393045046297665626145061593966864047076709310028069690294786645339349366928646398523517586604397657423858570152574121906902762935469068101356103808920642059402350527190677357731810393346483473699407857027241660852/276325502031086882594190411112337900762973683215772358188246587620436915790871486980713459299827218479538785417024636207184566304228462446203343324192784527339078954481676100334233311273147229827716694872640142934507820403448092816690587504233392017780785145757869627750211813071447971670115500981963181644219802727987215439202434859659008800237475806685128761036203705598355756030475556091473562971596216676105263603664934635162353515625*z^730 + 275075442409445376263921171296070594796103872378871855902623516975683652404361383789629497645907209067083878359686622095283729025087658243553638934171357526505231189624068386456943421812944199198718054753634719959792474136762776276704361807858603977409387678009128985083542284918076910646361949642856432207601475120149948328852128444707682809544110195342924280487346504/88296213440184269785441895420513543108778298337604922302325190230115008593777985693156637237720911455074277813067942194361713003629133151489017832602795198965131046060397352020927591607878068742159730215158971117782504346477503897502465899629840639542787426788181748538738578260740099094385337756796615881874243282145074614035953375368249628570442299533798090911263545438744707880686805290630231230529925777379826812885402105748653411865234375*z^738 - 129456497689850077612339740942939156553059830972524183665072876965273817023921761892810147640056319233611703583418589154429913801911541671662946103353080378177574681769760298477719997882191855501255695580690828569986292166746254003766445910031217442744611928301515138488038005094432610315778976497019801406152624243184306356198755965911447519634068462166310014141391932/264033471183117610617483634005651878303489584617293169596541428412087253301006809518277111352506841760331072879270965157473887553225131821038588434054363367365464508195134938851926333258424733405731880909736874892158336241887935383572749118747828546816809859766112492603734005210687705524372620168629105603183269863073043942698310940871158090277230605143439811804867986965737806858712359646315582493231133983206019646279592253267765045166015625*z^746 + 155200961690731900153214055713130828453526630880670039350052523558144405415098628322245586952472440210904895628345152309403301551834600573156535825387813596743795665795436537393619532201063369775604173940322380488504216670763530610517848738364398736130445069648170609182033426001796323759331917884762685527826396397255138037558300977266082657143400797494207878292967827856/2011211660347701596925713402620366620907957308512008913915825781437184251167559537014701066804223740328143578702704979569245487352492798241796619989256200886068682160581904412433649157995014979629976345615293440541382524932815064737392195618318381514935595071060995536717330335430655349467827379569871267205102505211520958648302355018103946235836298392492781000022652760827721555588642339804405615103552165867425718866818700243718922138214111328125*z^754 - 680857066317421985016326359570906763067539323840670261832268133402291440997383900702068971797447124468001372193375548597140322729674041031297516552445983199189008379782718932851174327770988935937386826186808422782943100311132628748448732763892438542668332671679137792614366368746130550751618507370507765422074655526308986233120271246939468493203909258262612961119167189523984336/56057183629743158144257630224532479034901898829559458653400278131638082899618382263280988105968569970555367471591117887506373831597573420144077714449721177178571721896155890177066074104442305444820074226847931484723822489235810722829195714306285988375795117884054053329508568730040105280105753754375358640177541541910080621510821958603730794251163953067008805949045682249868517670628645799058338510630718696258946049892681006912827572785317897796630859375*z^762 + 7750058381013557722248770183009401926443887083742596092223058181846957838703144241498088283425767172647263825735980888076165949551791256760608557886338277525040272221521727426610711198539548617093038846798326890026921969833828298327442930654430169535922644402183187131151801193493883433872694706094156614992285441888597389206256197420958099336018186973319263476650888602778187102676868/4053930615846763871908499336428949116304108345886005870883271709176134423814109018742948638737780339249000835467474392467841609062391210625306974017949034010078735620485442727099595000693940605295650586093937478281573906472845315788325803848074541804741824541884493272140180493437701137654246360090889543130901282404559306165393609275294574780077091663387493066350780958786383398797990713465798876101400547088394024513448047964650024034608197398483753204345703125*z^770 - 174724720842993182580456361952574488844254609266145923882067687365633731298708563119363239907930205391985187107256598863329348062459111694386077493656676761084352934516917736472946966608837201435608057857961865315137564104729780639758140758262305274406307556904250422277795220014659975227349358370095617027511739573084462426241564060671550431487993651037662533810423249473655096293927372244524/580638849950743311804047395386986440139776702342726848028762235922963931202600334245091955342153490063656914571384097382784156613136964186504632990955629512224865300457203685834698519196677148799475091542755015583131734969772957191188946965748693540054745725896188973227638965628936397152352538975548139912174491662800297980097891796963740323033895456458334290238632251999673952604408079850454380270657349021372140478409107188038800669855079108873042277991771697998046875*z^778 + 9017968844029096356493162691498460296202723419273865136521657682453085168401884521032846935520636089758086381346815442424465524523128662029021925533844828540294451679041015413294487464151656629425264131583142828181551848182453186199505459407197374673557047108854266901115604674133846360241624292390951186986163955199855403681669117897155614683447995085519468535923033024315749138341913021508938701104/190381861777576997779073730510383059065424745576659230883847236770226280989740140929629550698635797303617177938480799697009973899461627169217048081498121718966922351575945615920549164333016982527732316810928146958385792485662248313500898047540402916172847196767902345743379247445540532552710363114979183073360650470126806746338654358842577341491843909762242494378398292964703218459308422571937428214848121846436083876107602356915567252989985630124190298754251562058925628662109375*z^786 + O(z^794)
```

```sage
omega = Omega({triangle: f for triangle in S.label_iterator()})
```

We integrate to find the cohomology class this corresponds to.

```sage
{gen: omega.integrate(gen).real() for gen in HS.homology().gens()}
```
